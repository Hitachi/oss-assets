apiVersion: apps/v1
kind: Deployment
metadata:
  name: mcp-inspector
  namespace: agents
spec:
  replicas: 1
  selector:
    matchLabels: { app: mcp-inspector }
  template:
    metadata:
      labels: { app: mcp-inspector }
    spec:
      containers:
        - name: inspector
          image: ghcr.io/modelcontextprotocol/inspector:latest
          ports:
            - { name: ui,    containerPort: 6274 }
            - { name: proxy, containerPort: 6277 }
          env:
            - { name: HOST, value: "0.0.0.0" }
            - { name: DANGEROUSLY_OMIT_AUTH, value: "true" }
            - { name: MCP_AUTO_OPEN_ENABLED, value: "false" }
            - { name: ALLOWED_ORIGINS, value: "http://localhost:6274" }
          readinessProbe:
            httpGet: { path: "/", port: 6274 }
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 2
          livenessProbe:
            httpGet: { path: "/", port: 6274 }
            initialDelaySeconds: 15
            periodSeconds: 20
            timeoutSeconds: 2
---
apiVersion: v1
kind: Service
metadata:
  name: mcp-inspector
  namespace: agents
spec:
  type: NodePort
  selector: { app: mcp-inspector }
  ports:
    - { name: ui,    port: 6274, targetPort: 6274, nodePort: 30674 }
    - { name: proxy, port: 6277, targetPort: 6277, nodePort: 30677 }
